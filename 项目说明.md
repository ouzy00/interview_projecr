# 1.项目需求

这是一个预约功能，可以预约未来2天至7天，每天09:00 - 15:00之内每个小时可以预约6个服务。

1. 请设计一些数据结构来表达可预约项。

2. 请实现一个 GET API 用以读取全部可预约状态

3. 请实现一个 POST API 用以预约某个时间段的服务（可预约数量 -1），如果请求的时间段不能预约，则返回状态码 40x ，请在代码中说明 x 是多少以及为何选择该状态码。

# 2.使用框架及技术

1.springboot

2.mybatise

3.webservice&CXF

# 3.使用数据库

Oracle数据库

# 4.脚本说明

## 4.1.描述

1.数据库对象结构脚本（路径：interview_project\src\database\数据库对象结构脚本）

脚本包括：ORDERALL.sql，ORDERINFO.sql，ORDERTIMEPARAM.sql，SEQ_ORDERID.sql；

2.数据库数据执行脚本（路径：interview_project\src\database\数据库数据执行脚本）。

## 4.2.执行顺序

1.先执行数据库对象结构脚本目录下的所有.sql文件；

2.再执行数据库数据执行脚本目录下的.sql文件。

# 4.3项目代码说明

## 4.3.1.java代码

1.client--用于测试相关预约功能；

2.config--CXF配置类；

3.mapper--mybatise中sqlmap映射mapper类；

4.service--预测功能相关接口类与实现类。

## 4.3.2.配置文件

1.mapper/mapper-order.xml--mybatise中sqlmap配置文件；

2.application.properties--springboot配置文件

# 4.4.业务逻辑

## 4.4.1.查询全部可预约的状态信息

先初始化可预约信息表数据ORDERALL，表结构如下：

| 字段名称 | 字段类型   | 字段注释     |
| :------- | :--------- | :----------- |
| YY_DATE  | VARCHAR(8) | 可预约日期   |
| YY_TIME  | VARCHAR(4) | 可预约时间   |
| NUM      | NUMBER     | 剩余预约总量 |

查询可预约的状态信息通过可预约日期进行条件关联查询出未来2天至7天可预约的结果。

## 4.4.2.执行预约功能

业务逻辑顺序如下：

1.校验预约日期，预约时间是否在可预约时间范围内，如果不在可预约范围内，则返回401：“所选日期不在可预约日期范围内”；

2.校验指定预约时间内剩余预约量，如果在指定预约时间内剩余可预约量为零，则返回402：“所选时间不在可预约时间范围内”；

3.以上两步校验成功且可在指定时间进行预约，执行预约操作，写一条orderinfo记录，同时更新orderall的剩余预约总量减一。





